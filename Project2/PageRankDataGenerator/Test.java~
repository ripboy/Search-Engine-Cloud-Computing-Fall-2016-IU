import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

/*  This class reads the output file generated by the HadoopPageRank program
*   It adds all the individual Page Rank of the Source URL
*   It then prints the sum, thus we can verify if it equals to 1.
*/

public class TestPageRankSum {
    public static void main(String[] args) {
        // The name of the file to open.
        String fileName = args[0];
        // This will reference one line at a time
        String line = null;
        try {
            // FileReader reads text files in the default encoding.
            FileReader fileReader =
                    new FileReader(fileName);
            // Always wrap FileReader in BufferedReader.
            BufferedReader bufferedReader =
                    new BufferedReader(fileReader);
            //Add the PageRank of each SourceURL to check if the sum = 1
            double sum = 0.0;
            while ((line = bufferedReader.readLine()) != null) {
                sum += Double.parseDouble(line.split("\t")[1]);
            }
            System.out.println(sum);
        } catch (FileNotFoundException ex) {
            System.out.println("Unable to open file '" +fileName+"'");
        } catch (IOException ex) {
            System.out.println("Error reading file '"+fileName+"'");
        }
    }
}
